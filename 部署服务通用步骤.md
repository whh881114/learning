# 部署服务通用步骤


## 思路
- **首先，要明确所部署的服务要达到的期望值是什么？** 举例来说，在实验环境中，我想要在一台linux主机上搭建vsftpd服务，期望值如下：
  - 实验环境中所有主机可以访问vsftpd服务。
  
  - 允许匿名用户登录，可以查看文件并下载，但无上传文件权限。
  
  - 禁止linux本地用户登录。
  
  - 允许虚拟用户登录，限制用户的根目录，可以上传和下载文件。


- **其次，在部署阶段，先忽略期望值。第一目标是将服务运行起来，其他的都不重要。** 原因如下：
  - 对任何人来说，部署一个新服务，无论这个服务是复杂的还是简单的，如果这个服务一直报错无法正常运行，并且你也不知道从何排查，  
    更让人头疼的是，你花上几天的时间也解决不了，这无疑是在摧毁个人自信心。（部署过OpenStack的人肯定深有体会。）
  
  - 基于以上情况，首先使用默认配置，将服务正常运行起来，这是恢复个人自信心最为关键的一步。


- **然后，完成期望值中的每一条。** 部署的服务可能过于庞大且复杂，在执行这个阶段时，应该分解期望值，回到第一步。  
  针对每一项的期望值，部署成功后，还需要做相对应的测试。以本文中的vsftpd服务做讲解。
  - 实验环境中所有主机可以访问vsftpd服务。
    - 验证方法：
      - 检查vsftpd防火墙设置，期望结果是无防火墙设置，或者是防火墙允许vsftpd相应的端口可以访问。
      - 使用多台主机进行登录测试，期望结果是多台主机可以登录成功。
  
  - 允许匿名用户登录，可以查看文件并下载，但无上传文件权限。
    - 验证方法：
      - 使用匿名用户登录，期望结果登录成功。
      - 下载文件，上传文件，期望结果是可以下载文件，无法上传文件。
  
  - 禁止linux本地用户登录。
    - 验证方法：
      - 先允许本地用户登录，进行登录测试，如果本地用户可以成功登录，那么关闭本地用户登录，再使用本地用户登录测试，期望结果是登录失败。
  
  - 允许虚拟用户登录，限制用户的根目录，可以上传和下载文件。
    - 验证方法：
      - 虚拟用户登录，期望结果是登录成功。
      - 限制用户的根目录，匿名用户登录后，期望结果是使用pwd查看当前目录是"/"，执行切换目录到linux系统目录（/home，/etc）失败。
      - 下载文件，上传文件，期望结果是可以下载文件，也可以上传文件。


- **最后，编写记录，不限格式。**


## 心得体会
- 面对一个新服务部署，应该先去服务的官方网站，了解这个服务所能提供的功能是什么，做到这一点就可以了。

- 目前IT相关产品或技术的官方网站基本上是英文，上面的**Documents**是`技术手册`，而不是让你`从入门到精通`系列书箱。

- 部署前，可以先到网上看一些中文的技术博客 **（使用Google搜索）** ；部署时，照猫画虎，遇到报错时，不用慌张，一段英文而已，  
  报错都会写得很直接的，如果看不懂，那么就直接在`AI`让其翻译，如`ChatGPT`或`Gemini`，`AI`还会提供解决方法。  
  对于`AI`的结果，需要个人自行判断。

- 成功部署服务后，如果要深入的了解工作原理和配置，那么就去官方网站上查看**Documents**即可。

- **按需步骤：** 在另外一台主机上，把服务重新部署一遍。这一点很重要，因为在第一次的部署过程中，会存在大量的排错或调整步骤，  
  而等到服务部署完成后再来记录步骤，可以会漏掉一些关键的配置，所以在新环境中重新部署一次是很有必要的。  
  目前，部署的服务基本上都是在容器平台，那么就根据官方的删除步骤完成即可。
